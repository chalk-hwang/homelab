volumes:
  tsdproxy-data:
secrets:
  tsdproxy_tailscale_authkey:
    file: $SECRETS_DIR/tsdproxy_tailscale_authkey
#     - TS_ROUTES=10.2.0.0/16
#     network_mode: host
services:
  tsdproxy:
    image: almeidapaulopt/tsdproxy:latest
    container_name: tsdproxy
    profiles: ["base"]
    privileged: true
    secrets:
      - tsdproxy_tailscale_authkey
    networks:
      - default
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - tsdproxy-data:/data
      - $DATA_DIR/tsdproxy:/config
    restart: unless-stopped
